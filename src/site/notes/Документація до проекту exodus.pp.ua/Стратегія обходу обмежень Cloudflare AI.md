---
{"title":"Стратегія обходу обмежень Cloudflare AI","dg-publish":true,"dg-metatags":null,"dg-home":null,"permalink":"/dokumentacziya-do-proektu-exodus-pp-ua/strategiya-obhodu-obmezhen-cloudflare-ai/","dgPassFrontmatter":true,"noteIcon":""}
---

ч
Щоб заекранувати всі конструкції типу `{{ текст чи команда }}`, які можуть сприйматися як виклики шаблону (наприклад, у Nunjucks), потрібно знайти ці вирази в тексті та замінити їх на екрановані версії, тобто `\{\{ текст чи команда \}\}`. Це запобігає їх інтерпретації як команд шаблону під час обробки тексту та усуває можливі помилки компіляції. Ось як це зробити:

### Покроковий процес
1. **Ідентифікація конструкцій**: Знайдіть у тексті всі вирази, укладені в подвійні фігурні дужки, наприклад, `{{ variable }}` або `{{ $node["example"] }}`.
2. **Екранування**: Додайте перед кожною такою конструкцією зворотний слеш `\`, щоб отримати `\{\{ variable \}\}` або `\{\{ $node["example"] \}\}`.
3. **Перевірка**: Переконайтеся, що всі подібні вирази змінено, а текст залишається читабельним і придатним для подальшого використання.

### Приклад
#### Вихідний текст:
```
Використовуйте {{ $input.prompt }} для запиту та отримайте {{ result }} як результат.
```

#### Заекранований текст:
```
Використовуйте \{\{ $input.prompt \}\} для запиту та отримайте \{\{ result \}\} як результат.
```

### Чому це важливо?
У системах, таких як Nunjucks, вирази в подвійних фігурних дужках (`{{ ... }}`) сприймаються як команди для підстановки значень або виконання логіки. Якщо текст із такими виразами передається в шаблон без екранування, система намагатиметься їх обробити, що може призвести до помилок, якщо змінні не визначені. Екранування (`\{\{ ... \}\}`) повідомляє системі, що це просто текст, а не команда.

### Як реалізувати?
- **Ручне редагування**: Якщо текст невеликий, ви можете вручну додати `\` перед кожною парою фігурних дужок.
- **Автоматизація**: Для великих текстів використайте регулярний вираз, наприклад:
  - Знайти: `\{\{([^}]+)\}\}`
  - Замінити на: `\{\{$1\}\}`
  - У JavaScript: 
    ```javascript
    const text = "Використовуйте {{ $input.prompt }} для запиту";
    const escapedText = text.replace(/\{\{([^}]+)\}\}/g, "\\{\\{$1\\}\\}");
    console.log(escapedText); // "Використовуйте \{\{ $input.prompt \}\} для запиту"
    ```
