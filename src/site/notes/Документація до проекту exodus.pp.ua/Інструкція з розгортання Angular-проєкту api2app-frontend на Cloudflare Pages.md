---
{"title":"Інструкція з розгортання Angular-проєкту api2app-frontend на Cloudflare Pages","dg-publish":true,"dg-metatags":null,"dg-home":null,"permalink":"/dokumentacziya-do-proektu-exodus-pp-ua/instrukcziya-z-rozgortannya-angular-proyektu-api2app-frontend-na-cloudflare-pages/","dgPassFrontmatter":true,"noteIcon":""}
---



Цей документ описує покроковий процес розгортання Angular-проєкту `api2app-frontend` на Cloudflare Pages із додаванням української локалізації, інтеграцією TailwindCSS та перевіркою коректності налаштувань. Інструкція відформатована для використання в Obsidian, перевірена на логіку процесів і оптимізована для зручності виконання.

---

## 1. Додавання української локалізації

Щоб додати підтримку української мови до проєкту, виконайте наступні кроки:

### 1.1. Створення файлу перекладу
- У папці `src/locale` створіть файл `messages.uk.json`.
- Скопіюйте структуру з існуючого файлу, наприклад, `messages.en.json`, і перекладіть усі рядки інтерфейсу на українську мову.
  - **Приклад:**
    ```json
    {
      "welcome": "Ласкаво просимо до додатку",
      "title": "Головна сторінка"
    }
    ```

### 1.2. Реєстрація української локалі у конфігурації Angular
- Відкрийте файл `angular.json`.
- У секції `projects -> api2app-frontend -> i18n -> locales` додайте запис для української локалі:
  ```json
  "uk": {
    "translation": "src/locale/messages.uk.json",
    "baseHref": "uk/"
  }
  ```
- У секції `configurations.production.localize` додайте `"uk"` до масиву локалей, наприклад:
  ```json
  "localize": ["en", "ru", "fr", "uk"]
  ```
  - Це забезпечить збірку додатку для всіх зазначених мов під час продакшн-збірки.

### 1.3. Налаштування мови за замовчуванням
- За замовчуванням вихідна мова проєкту – англійська (`"en"`), як вказано в `sourceLocale` у `angular.json`.
- Щоб зробити українську мову основною для користувачів:
  - **Рекомендований спосіб:** Налаштуйте редирект із кореня сайту (`/`) на `/uk/` після розгортання (докладніше в розділі 3.6).
  - **Альтернатива:** Змініть `sourceLocale` на `"uk"`, але це вимагатиме переробки всіх перекладів (менш оптимально для існуючого проєкту).

### 1.4. Реалізація перемикача мов
- Додайте в інтерфейс перемикач мов (наприклад, випадаючий список у шапці сайту).
- Для кожної мови налаштуйте перенаправлення на відповідний URL:
  - Українська: `/uk/`
  - Англійська: `/en/`
  - Російська: `/ru/`
  - Французька: `/fr/`
- **Приклад коду (TypeScript):**
  ```typescript
  switchLanguage(language: string) {
    window.location.href = `/${language}/`;
  }
  ```
- Переконайтеся, що після переходу на `/uk/` відображаються українські переклади.

---

## 2. Інтеграція TailwindCSS

TailwindCSS уже частково інтегрований у проєкт. Виконайте ці кроки для повного налаштування:

### 2.1. Перевірка наявності TailwindCSS
- Відкрийте `package.json` і переконайтеся, що `tailwindcss` (версія `^3.4.3`), `@tailwindcss/forms` та `autoprefixer` є в `devDependencies`.
- Перевірте наявність файлу `tailwind.config.js` у корені проєкту.

### 2.2. Налаштування глобальних стилів
- Відкрийте `src/styles.css` і додайте директиви Tailwind (якщо їх немає):
  ```css
  @tailwind base;
  @tailwind components;
  @tailwind utilities;
  ```

### 2.3. Автоматизація генерації CSS
- У проєкті використовується команда для генерації стилів:
  ```
  npx tailwindcss -i ./src/styles.css -o src/assets/css/styles.css
  ```
- **Оптимізація:** Додайте скрипт до `package.json` для автоматизації:
  ```json
  "build:tailwind": "npx tailwindcss -i ./src/styles.css -o src/assets/css/styles.css",
  "build": "npm run build:tailwind && ng build --localize"
  ```
  - Це забезпечить генерацію CSS перед основною збіркою Angular.
- Angular автоматично копіює вміст `src/assets` до `dist/api2app-frontend/assets/`.

### 2.4. Перевірка інтеграції
- Запустіть проєкт локально (`ng serve`) і перевірте, чи застосовуються класи Tailwind (наприклад, `p-4`, `bg-blue-500`).
- Якщо стилі не працюють, переконайтеся, що згенерований файл `styles.css` доступний і підключений.

### 2.5. Перевірка Flowbite (опціонально)
- Якщо використовуються компоненти Flowbite, переконайтеся, що вони відображаються коректно після генерації стилів Tailwind.

---

## 3. Розгортання на Cloudflare Pages

### 3.1. Збірка проєкту для продакшну
- Виконайте команду:
  ```
  npm run build:localize
  ```
- Це створить локалізовані версії додатку в `dist/api2app-frontend`:
  ```
  dist/api2app-frontend/
  ├── en/index.html
  ├── ru/index.html
  ├── fr/index.html
  ├── uk/index.html
  ├── assets/
  └── ...
  ```

### 3.2. Створення проєкту на Cloudflare Pages
- Увійдіть до Cloudflare, перейдіть до розділу **Pages**.
- Натисніть **Create a project**, виберіть GitHub-репозиторій `api2app-frontend` і підключіть його.

### 3.3. Налаштування процесу збірки
- У налаштуваннях проєкту вкажіть:
  - **Production branch:** `main`
  - **Build command:** `npm run build:localize`
  - **Build output directory:** `dist/api2app-frontend`

### 3.4. Встановлення версії Node
- Angular 17+ потребує Node 18+. У розділі **Environment variables** додайте:
  - Ключ: `NODE_VERSION`
  - Значення: `18`

### 3.5. Перше розгортання
- Натисніть **Save and Deploy**. Cloudflare виконає збірку і розгорне сайт за адресою типу `your-project-name.pages.dev`.

### 3.6. Налаштування динамічних маршрутів для SPA
- Створіть файл `public/_redirects` із вмістом:
  ```
  /en/*    /en/index.html   200
  /ru/*    /ru/index.html   200
  /fr/*    /fr/index.html   200
  /uk/*    /uk/index.html   200
  ```
- Це забезпечить коректну роботу внутрішніх маршрутів Angular для кожної локалі.

---

## 4. Додаткові налаштування та перевірка

### 4.1. Перевірка української локалізації
- Відкрийте сайт на Cloudflare Pages, перейдіть на `/uk/` через перемикач мов.
- Переконайтеся, що всі тексти відображаються українською. У разі пропущених перекладів оновіть `messages.uk.json` і повторіть деплой.

### 4.2. Перевірка стилів
- Перегляньте сторінки, щоб упевнитися, що TailwindCSS працює. У консолі браузера перевірте завантаження `/assets/css/styles.css`.

### 4.3. Моніторинг логів
- У Cloudflare Pages Dashboard (вкладка **Deployments**) перевірте логи збірки на відсутність помилок.

### 4.4. Користувацький домен (опціонально)
- Налаштуйте власний домен у Cloudflare Pages і додайте DNS-записи для доступу до всіх локалей.

### 4.5. Оновлення проєкту
- Для внесення змін (наприклад, нових перекладів) зробіть commit і push до репозиторію. Cloudflare автоматично перебудує і розгорне оновлену версію.

---

## Оптимізація та логіка процесів

1. **Локалізація:**
   - Використання редиректів замість зміни `sourceLocale` спрощує додавання нової мови без рефакторингу коду.
2. **TailwindCSS:**
   - Інтеграція генерації CSS у скрипт `build` усуває потребу в ручному запуску команд.
3. **Розгортання:**
   - Автоматизація деплою через Git і Cloudflare Pages зменшує час на оновлення до кількох хвилин.

Після виконання цих кроків ваш додаток буде доступний на Cloudflare Pages із підтримкою української локалізації, готовий до використання та подальшого масштабування!